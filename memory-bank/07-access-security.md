# Доступ и безопасность

## Аутентификация
- JWT access/refresh, проверка через `Authorization: Bearer`.
- Хэширование паролей: Argon2.
- Саморегистрация отсутствует.

## RBAC (системные роли)
- `admin`: полный доступ; при наличии `departmentIds` действует как scoped admin.
- `gip`: доступ к собственным проектам и задачам; создание проектов в своих подразделениях.
- `executor`: доступ к своим задачам и таймшитам.
- `accountant`: чтение проектов, доступ к таймшитам всех сотрудников.

## Проектные роли
- `manager` и `lead_specialist`: могут редактировать проект, WBS, команду, задачи.
- `executor` и `accountant`: чтение проекта, работа со своими задачами.

## Политики доступа (сервисный слой)
- Проекты: доступ по `project_members`, исключение — admin и бухгалтер (read).
- Scoped admin: доступ только в пределах `departmentIds`.
- Таймшиты: admin пишет/читает любые; бухгалтер — читает любые; gip — читает участников своих проектов; остальные — только свои.
- Задачи:
  - executor видит и меняет только свои задачи;
  - задачи с `approval_status=rejected` скрыты;
  - `subcontract` с `pending` нельзя двигать.
- Файлы: бухгалтеру запрещено создание/редактирование/удаление; владельцу и админу — разрешено.

## Аудит и логирование
- Записи в `audit_log` по ключевым действиям (проекты, задачи, таймшиты, файлы, чат).

## Защита данных
- Ограничение ставок: видят admin/gip/accountant и сам пользователь.
- Контрагентские пользователи не могут иметь подразделений и не получают роли, кроме `executor`.
