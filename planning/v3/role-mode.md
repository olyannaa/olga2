# Ролевая модель v3 (актуальная реализация)

## Глобальные роли
- Админ (`admin`)
  - Полный админ: `departmentIds` пусто — полный доступ.
  - Админ со скоупом: доступ ограничен проектами и пользователями своих подразделений.
  - Флаг `canApproveSubcontracts` открывает доступ к согласованию субподрядов по своим подразделениям.
- ГИП (`gip`)
  - Может создавать проекты в своих подразделениях и становится менеджером проекта.
  - Управляет своими проектами, видит аналитику и бюджет по ним.
- Исполнитель (`executor`)
  - Видит проекты, где состоит участником, и свои задачи.
  - Ведет свои таймшиты.
- Бухгалтер (`accountant`)
  - Имеет доступ к таймшитам всех сотрудников и чтению проектов.
  - Имеет доступ к «Структуре организации» (UI) для просмотра/редактирования сотрудников без роли admin.

## Дополнительные атрибуты
- `departmentIds` + `primaryDepartmentId` — скоуп доступа и принадлежность к подразделениям.
- `canApproveSubcontracts` — возможность согласования субподрядов (только для admin).
- Контрагентские исполнители: `contractor_id`, роль только `executor`, без подразделений.

## Роли в рамках проекта
- `manager` — полный контроль проекта: свойства, WBS, команда, задачи, субподряды.
- `lead_specialist` — управление WBS/задачами/командой, создание субподрядов; без доступа к бюджету и полным затратам.
- `executor` — работа со своими задачами, чтение проекта.
- `accountant` — чтение проекта и бухгалтерских задач (без редактирования проекта).

## Ключевые права (сводно)
- Заявки на субподряд видят и согласуют только админы с флагом `canApproveSubcontracts` и доступом к подразделению проекта.
- ГИП и админы видят список «Мои задачи» только по назначенным задачам (фильтр по assignee).
- Исполнители и главные специалисты не видят задачи, назначенные бухгалтерам.
